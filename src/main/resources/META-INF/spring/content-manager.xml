<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:osgi="http://www.eclipse.org/gemini/blueprint/schema/blueprint"
       xmlns:spring="http://camel.apache.org/schema/spring"
       xmlns:util="http://www.springframework.org/schema/util"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
                        http://www.eclipse.org/gemini/blueprint/schema/blueprint http://www.eclipse.org/gemini/blueprint/schema/blueprint/gemini-blueprint.xsd
                        http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util.xsd">

    <bean id="contentmanager.urlResolverFactory" class="org.jahia.modules.contentmanager.configuration.URLResolverFactory">
        <property name="cacheService" ref="ehCacheProvider"/>
    </bean>

    <util:list id="menus">
        <ref bean="bluemenu"/>
        <ref bean="editmode.managers.menu"/>
    </util:list>

    <!-- Content Manager -->
    <bean id="Toolbar.Item.ContentManager" class="org.jahia.services.uicomponents.bean.toolbar.Item">
        <property name="parent" ref="menus"/>
        <property name="actionItem">
            <bean class="org.jahia.ajax.gwt.client.widget.toolbar.action.SwitchConfigActionItem">
                <property name="configurationName" value="contentmanagermode"/>
                <property name="updateOnMainNodeRefresh" value="true"/>
                <property name="checkPermissionOnSite" value="true"/>
                <property name="noChecksInMode" >
                    <set>
                        <value>adminmode</value>
                        <value>dashboardmode</value>
                        <value>studiomode</value>
                    </set>
                </property>
            </bean>
        </property>
        <property name="titleKey" value="label.contentmanager"/>
        <property name="icon" value="content-manager-1616"/>
        <property name="requiredPermission" value="contentManager"/>
    </bean>

    <bean name="org.jahia.bin.ContentManager" parent="abstractRender" class="org.jahia.bin.Edit">
        <property name="sessionExpiryTime" value="${sessionExpiryTime}"/>
        <property name="editConfiguration" ref="contentmanagermode"/>
        <property name="availableInDistantPublicationServerMode" value="false"/>
        <property name="workspace" value="default"/>
        <property name="urlResolverFactory" ref="contentmanager.urlResolverFactory"/>
    </bean>

    <bean name="contentmanagerRendererMapping" class="org.springframework.web.servlet.handler.SimpleUrlHandlerMapping">
        <property name="urlMap">
            <map>
                <entry key="/contentmanager/**" value-ref="org.jahia.bin.ContentManager"/>
                <entry key="/contentmanagerframe/**" value-ref="org.jahia.bin.ContentManager"/>
            </map>
        </property>
    </bean>

    <bean name="ContentManagerFilter" class="org.jahia.modules.contentmanager.configuration.ContentManagerFilter">
        <property name="priority" value="1"/>
    </bean>

    <bean id="contentmanagermode" class="org.jahia.services.uicomponents.bean.editmode.EditConfiguration">

        <property name="requiredPermission" value="contentManager"/>
        <property name="nodeCheckPermission" value="$site"/>
        <property name="defaultLocation" value="$defaultSiteHome"/>
        <property name="defaultUrlMapping" value="/cms/contentmanager"/>
        <property name="sitesLocation" value="/sites/*"/>
        <property name="refreshOnExternalModification" value="${jahia.ui.refreshOnExternalModification:true}"/>

        <property name="nonEditableTypes">
            <set>
                <value>jmix:studioOnly</value>
            </set>
        </property>

        <property name="excludedNodeTypes">
            <set>
                <value>jmix:hiddenType</value>
            </set>
        </property>

        <property name="topToolbars">
            <list/>
        </property>

        <property name="sidePanelToolbar">
            <bean class="org.jahia.services.uicomponents.bean.toolbar.Toolbar">
                <property name="items">
                    <list/>
                </property>
            </bean>
        </property>

        <property name="mainModuleToolbar">
            <bean class="org.jahia.services.uicomponents.bean.toolbar.Toolbar">
                <property name="items">
                    <list/>
                </property>
            </bean>
        </property>

        <property name="contextMenu">
            <bean class="org.jahia.services.uicomponents.bean.toolbar.Toolbar">
                <property name="items">
                    <list/>
                </property>
            </bean>
        </property>

        <property name="tabs">
            <list/>
        </property>

        <!-- edit engine -->
        <property name="engineConfigurations">
            <map>
                <entry key="nt:base">
                    <bean class="org.jahia.services.uicomponents.bean.editmode.EngineConfiguration">
                        <property name="engineTabs">
                            <list>
                                <!--<ref bean="Engine.Tab.ContentAndLayout"/>-->
                                <ref bean="Engine.Tab.Content"/>
                                <ref bean="Engine.Tab.ListOrdering"/>
                                <ref bean="Engine.Tab.Layout"/>
                                <ref bean="Engine.Tab.Metadata"/>
                                <ref bean="Engine.Tab.Seo"/>
                                <ref bean="Engine.Tab.Categories"/>
                                <ref bean="Engine.Tab.Options"/>
                                <ref bean="Engine.Tab.LiveRoles"/>
                                <ref bean="Engine.Tab.EditRoles"/>
                                <ref bean="Engine.Tab.Usages"/>
                                <ref bean="Engine.Tab.History"/>
                                <ref bean="Engine.Tab.Versioning"/>
                                <ref bean="Engine.Tab.Visibility"/>
                                <ref bean="Engine.Tab.ContributeMode"/>
                            </list>
                        </property>
                        <property name="creationButtons">
                            <list>
                                <ref bean="Engine.Button.WorkInProgress"/>
                                <ref bean="Engine.Button.Create"/>
                                <ref bean="Engine.Button.CreateAndNew"/>
                            </list>
                        </property>
                        <property name="editionButtons">
                            <list>
                                <ref bean="Engine.Button.WorkInProgress"/>
                                <ref bean="Engine.Button.Update"/>
                            </list>
                        </property>
                        <property name="commonButtons">
                            <list>
                                <ref bean="Engine.Button.Cancel"/>
                            </list>
                        </property>
                    </bean>
                </entry>
            </map>
        </property>

    </bean>

</beans>